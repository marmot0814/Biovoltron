<!-- HTML header for doxygen 1.9.1-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Biovoltron: Tutorial</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="doxygen-awesome.css" rel="stylesheet" type="text/css"/>
<link href="doxygen-awesome-sidebar-only.css" rel="stylesheet" type="text/css"/>
<link href="doxygen-awesome-sidebar-only-darkmode-toggle.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="doxygen-awesome-darkmode-toggle.js"></script>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Biovoltron
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.1 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('tutorial.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title">Tutorial </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p><a class="anchor" id="md_doc_markdown_tutorial"></a></p>
<p>This document provides example recipes on how to carry out particular tasks using <b>Biovoltron</b>.</p>
<h1><a class="anchor" id="autotoc_md22"></a>
Read sequence files</h1>
<ul>
<li>Combined with <code>std::ranges</code>, biovoltron enable users to easily input common bioinformation format.</li>
</ul>
<div class="fragment"><div class="line"><span class="preprocessor">#include &lt;iostream&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;sstream&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;ranges&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;biovoltron/file_io/fasta.hpp&gt;</span></div>
<div class="line"> </div>
<div class="line"><span class="keyword">using namespace </span>biovoltron;</div>
<div class="line"> </div>
<div class="line"><span class="keyword">auto</span> fasta = R<span class="stringliteral">&quot;(&gt;chr1</span></div>
<div class="line"><span class="stringliteral">ACGT</span></div>
<div class="line"><span class="stringliteral">&gt;chr1</span></div>
<div class="line"><span class="stringliteral">AGGCTGA</span></div>
<div class="line"><span class="stringliteral">&gt;chr1</span></div>
<div class="line"><span class="stringliteral">GGAGTATAATATATATATATATAT)&quot;;</span></div>
<div class="line"><span class="stringliteral"></span> </div>
<div class="line"><span class="stringliteral"></span><span class="keywordtype">int</span> main() {</div>
<div class="line">    <span class="keyword">auto</span> input = std::istringstream(fasta);</div>
<div class="line">    <span class="keywordflow">for</span> (<span class="keyword">auto</span>&amp; r : std::ranges::istream_view&lt;FastaRecord&lt;true&gt;&gt;(input)) {</div>
<div class="line">        std::cout &lt;&lt; <span class="stringliteral">&quot;name: &quot;</span> &lt;&lt; r.name &lt;&lt; <span class="charliteral">&#39;\n&#39;</span>;</div>
<div class="line">        std::cout &lt;&lt; <span class="stringliteral">&quot;seq : &quot;</span> &lt;&lt; r.seq &lt;&lt; <span class="charliteral">&#39;\n&#39;</span>;</div>
<div class="line">    }</div>
<div class="line">    <span class="keywordflow">return</span> 0;</div>
<div class="line">}</div>
</div><!-- fragment --><h1><a class="anchor" id="autotoc_md23"></a>
Construction and assignment of biovoltron::istring symbols</h1>
<ul>
<li>The design of <code>biovoltron::istring</code> makes dna/rna string convert to numeric/bit representation easily.</li>
</ul>
<div class="fragment"><div class="line"><span class="preprocessor">#include &lt;cassert&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;iostream&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;biovoltron/utility/istring.hpp&gt;</span></div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">int</span> main() {</div>
<div class="line">    <span class="keyword">using namespace </span>std::string_literals;</div>
<div class="line">    <span class="keyword">using namespace </span>biovoltron;</div>
<div class="line"> </div>
<div class="line">    <span class="keyword">const</span> <span class="keyword">auto</span> s = 12031_s;</div>
<div class="line">    assert(Codec::hash(s) == 0b01&#39;10&#39;00&#39;11&#39;01);</div>
<div class="line">    assert(Codec::rhash(0b01&#39;10&#39;00&#39;11&#39;01, 5) == s);</div>
<div class="line">    assert(Codec::to_istring(<span class="stringliteral">&quot;ACNGGTT&quot;</span>) == 0142233_s);</div>
<div class="line">    assert(Codec::rev_comp(<span class="stringliteral">&quot;ACNGGTT&quot;</span>) == <span class="stringliteral">&quot;AACCNGT&quot;</span>s);</div>
<div class="line">    assert(Codec::rev_comp(s) == 20312_s);</div>
<div class="line">    std::cout &lt;&lt; s &lt;&lt; <span class="charliteral">&#39;\n&#39;</span>;</div>
<div class="line">    <span class="keywordflow">return</span> 0;</div>
<div class="line">}</div>
</div><!-- fragment --><h1><a class="anchor" id="autotoc_md24"></a>
Compressed vector(DibitVector) along with std::ranges</h1>
<ul>
<li>Not only <code>biovoltron::istring</code>, <code>biovoltron::DibitVector</code> can also paired with std::ranges easily.</li>
</ul>
<div class="fragment"><div class="line"><span class="preprocessor">#include &lt;algorithm&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;iostream&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;ranges&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;biovoltron/container/xbit_vector.hpp&gt;</span></div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">int</span> main() {</div>
<div class="line">    <span class="keyword">auto</span> v = biovoltron::DibitVector&lt;&gt;{3, 2, 1, 2, 3, 0, 0, 1, 2};</div>
<div class="line">    assert(v.size() == 9);</div>
<div class="line">    assert(v.num_blocks() == 3);</div>
<div class="line"> </div>
<div class="line">    <span class="keyword">auto</span> base_view = std::views::transform([](<span class="keyword">auto</span> c){ <span class="keywordflow">return</span> <span class="stringliteral">&quot;ACGT&quot;</span>[c]; });</div>
<div class="line">    <span class="keyword">auto</span> comp_view = std::views::transform([](<span class="keyword">auto</span> c){ <span class="keywordflow">return</span> 0b11u - c; });</div>
<div class="line"> </div>
<div class="line">    std::cout &lt;&lt; <span class="stringliteral">&quot;Reverse complement of &quot;</span>;</div>
<div class="line">    std::ranges::copy(v | base_view, std::ostream_iterator&lt;char&gt;{std::cout, <span class="stringliteral">&quot;&quot;</span>});</div>
<div class="line">    std::cout &lt;&lt; <span class="stringliteral">&quot; is &quot;</span>;</div>
<div class="line">    <span class="keywordflow">for</span> (<span class="keyword">auto</span> c : v | std::views::reverse | comp_view | base_view)</div>
<div class="line">        std::cout &lt;&lt; c;</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// result:</span></div>
<div class="line">    <span class="comment">// Reverse complement of TGCGTAACG is CGTTACGCA</span></div>
<div class="line">}</div>
</div><!-- fragment --><h1><a class="anchor" id="autotoc_md25"></a>
Serializer</h1>
<ul>
<li><code>biovoltron::Serializer</code> can archieve all kinds of random access container(satisfied by the std::ranges::random_access_range concept), including <code>biovoltron::xbit_vector</code>.</li>
</ul>
<div class="fragment"><div class="line"><span class="preprocessor">#include &lt;string&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;biovoltron/container/xbit_vector.hpp&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;biovoltron/utility/archive/serializer.hpp&gt;</span></div>
<div class="line"> </div>
<div class="line"><span class="keyword">template</span> &lt;<span class="keyword">typename</span> R&gt;</div>
<div class="line"><span class="keywordtype">void</span> test(<span class="keyword">const</span> R&amp; r, <span class="keyword">const</span> <span class="keywordtype">char</span>* path) {</div>
<div class="line">    <span class="keyword">using</span> biovoltron::Serializer;</div>
<div class="line">    {</div>
<div class="line">        <span class="keyword">auto</span> fout = std::ofstream{path, std::ios::binary};</div>
<div class="line">        Serializer::save(fout, r);</div>
<div class="line">    }</div>
<div class="line">    <span class="keyword">auto</span> r2 = R{};</div>
<div class="line">    {</div>
<div class="line">        <span class="keyword">auto</span> fin = std::ifstream{path, std::ios::binary};</div>
<div class="line">        Serializer::load(fin, r2);</div>
<div class="line">    }</div>
<div class="line">    assert(r == r2);</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keyword">struct </span>Point {</div>
<div class="line">    <span class="keywordtype">double</span> x;</div>
<div class="line">    <span class="keywordtype">double</span> y;</div>
<div class="line">    <span class="keyword">auto</span> operator&lt;=&gt;(<span class="keyword">const</span> Point&amp;) <span class="keyword">const</span> = <span class="keywordflow">default</span>;</div>
<div class="line">};</div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">int</span> main() {</div>
<div class="line">    test(std::vector{<span class="keyword">true</span>, <span class="keyword">false</span>, <span class="keyword">false</span>}, <span class="stringliteral">&quot;vector_bool.bin&quot;</span>);</div>
<div class="line">    test(std::vector{7, 5, 16, 8}, <span class="stringliteral">&quot;vector_int.bin&quot;</span>);</div>
<div class="line">    test(std::string{<span class="stringliteral">&quot;Exemplar&quot;</span>}, <span class="stringliteral">&quot;string.bin&quot;</span>);</div>
<div class="line">    test(std::vector{Point{0.0, 0.0}, {1.0, 2.0}, {3.0, 4.0}}, <span class="stringliteral">&quot;vector_point.bin&quot;</span>);</div>
<div class="line">    test(biovoltron::DibitVector&lt;&gt;{1, 0, 2, 3, 3, 0, 2}, <span class="stringliteral">&quot;DibitVector.bin&quot;</span>);</div>
<div class="line">    <span class="keywordflow">return</span> 0;</div>
<div class="line">}</div>
</div><!-- fragment --><h1><a class="anchor" id="autotoc_md26"></a>
FMIndex</h1>
<p>The memory usage for FMIndex in run time is affect by above parameters. Take a 3.1Gb human genome for example, the memory occupation can be calculate as follwing:</p><ul>
<li>bwt string:<code>3.1Gb / 4 = 0.775</code> Gb.</li>
<li>hierarchical occurrence table:<ul>
<li>L1 occ occupy fixed <code>3.1Gb * 16 / 256 = 0.194Gb</code> plus</li>
<li>L2 occ occupy <code>3.1Gb * 4 / occ_intv(16) = 0.775 Gb</code>.</li>
</ul>
</li>
<li>suffix array: <code>3.1Gb * 4 / sa_intv(1) = 12Gb</code>.<ul>
<li>Noticed that in default mode we dont sampling suffix value since this can reduce frequently memory allocation and intense computation when occurs massive query.</li>
</ul>
</li>
<li>lookup table: <code>4^lookup_len(14) * 4 / 1024^3 = 1Gb</code>.</li>
</ul>
<div class="fragment"><div class="line"><span class="preprocessor">#include &lt;iostream&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;ranges&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;biovoltron/algo/align/exact_match/fm_index.hpp&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;biovoltron/file_io/fasta.hpp&gt;</span></div>
<div class="line"> </div>
<div class="line"><span class="keyword">using namespace </span>biovoltron;</div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">int</span> main(<span class="keywordtype">int</span> argc, <span class="keywordtype">char</span>** argv) {</div>
<div class="line">  <span class="keywordflow">if</span> (argc != 2) {</div>
<div class="line">    std::cout &lt;&lt; <span class="stringliteral">&quot;argv[1] should be your fasta file.\n&quot;</span>;</div>
<div class="line">    <span class="keywordflow">return</span> 0;</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">auto</span> fname = std::string(argv[1]);</div>
<div class="line">  {</div>
<div class="line">    <span class="comment">// input</span></div>
<div class="line">    <span class="keyword">auto</span> ref = istring{};</div>
<div class="line">    <span class="keyword">auto</span> fin = std::ifstream(fname);</div>
<div class="line">    <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span>&amp; r : std::ranges::istream_view&lt;FastaRecord&lt;true&gt;&gt;(fin))</div>
<div class="line">      ref += r.seq;</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// fm-index only support &#39;ACTG&#39;, so we need to change &#39;N&#39; to &#39;ACGT&#39;</span></div>
<div class="line">    std::ranges::transform(ref, ref.begin(), [](<span class="keyword">auto</span>&amp; c) { return c % 4; });</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// build</span></div>
<div class="line">    <span class="keyword">auto</span> fmi = FMIndex{};</div>
<div class="line">    fmi.build(ref);</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// save</span></div>
<div class="line">    <span class="keyword">auto</span> fout = std::ofstream(fname + <span class="stringliteral">&quot;.fmi&quot;</span>, std::ios::binary);</div>
<div class="line">    fmi.save(fout);</div>
<div class="line">    std::cout &lt;&lt; fname + <span class="stringliteral">&quot;.fmi saved.\n&quot;</span>;</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// load</span></div>
<div class="line">  <span class="keyword">auto</span> fmi = FMIndex{};</div>
<div class="line">  {</div>
<div class="line">    <span class="keyword">auto</span> fin = std::ifstream(fname + <span class="stringliteral">&quot;.fmi&quot;</span>, std::ios::binary);</div>
<div class="line">    fmi.load(fin);</div>
<div class="line">    std::cout &lt;&lt; fname + <span class="stringliteral">&quot;.fmi loaded.\n&quot;</span>;</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// query</span></div>
<div class="line">  <span class="keywordflow">for</span> (<span class="keyword">auto</span> seed = istring{}; std::cin &gt;&gt; seed;) {</div>
<div class="line">    <span class="keyword">const</span> <span class="keyword">auto</span> [beg, end, offset] = fmi.get_range(seed, 0);</div>
<div class="line">    std::cout &lt;&lt; <span class="stringliteral">&quot;seed: &quot;</span> &lt;&lt; seed &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line">    std::cout &lt;&lt; <span class="stringliteral">&quot;seed offset: &quot;</span> &lt;&lt; offset &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line">    std::cout &lt;&lt; <span class="stringliteral">&quot;occurrence: &quot;</span> &lt;&lt; end - beg &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line">    <span class="keyword">const</span> <span class="keyword">auto</span> offsets = fmi.get_offsets(beg, end);</div>
<div class="line">    std::cout &lt;&lt; <span class="stringliteral">&quot;ref offsets: &quot;</span>;</div>
<div class="line">    <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span> offset : offsets) std::cout &lt;&lt; offset &lt;&lt; <span class="stringliteral">&quot; &quot;</span>;</div>
<div class="line">    std::cout &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line">  }</div>
<div class="line">}</div>
</div><!-- fragment --><h1><a class="anchor" id="autotoc_md27"></a>
SmithWaterman with simd acceleration</h1>
<ul>
<li><code>Biovoltron::SmithWaterman</code> is modern C++ Smith-Waterman wrapper which using SSW Library as a underlying code base.</li>
</ul>
<div class="fragment"><div class="line"><span class="preprocessor">#include &lt;iostream&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;biovoltron/utility/istring.hpp&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;biovoltron/algo/align/inexact_match/smithwaterman_sse.hpp&gt;</span></div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">int</span> main() {</div>
<div class="line">    <span class="keyword">using namespace </span>biovoltron;</div>
<div class="line">    <span class="keyword">const</span> <span class="keyword">auto</span> read = 1102111000031323330032232203332323_s;</div>
<div class="line">    <span class="keyword">const</span> <span class="keyword">auto</span> ref  = 2131100321101000010313231313001322323213_s;</div>
<div class="line">    <span class="keyword">const</span> <span class="keyword">auto</span> prof = SseSmithWaterman::get_profile(read);</div>
<div class="line">    <span class="keyword">const</span> <span class="keyword">auto</span> [score, score2, ref_beg, ref_end, read_beg, read_end, ref_end2, cigar] = SseSmithWaterman::align(prof, ref);</div>
<div class="line">    std::cout &lt;&lt; <span class="stringliteral">&quot;score: &quot;</span> &lt;&lt; score &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line">    std::cout &lt;&lt; <span class="stringliteral">&quot;ref_beg: &quot;</span> &lt;&lt; ref_beg &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line">    std::cout &lt;&lt; <span class="stringliteral">&quot;ref_end: &quot;</span> &lt;&lt; ref_end &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line">    std::cout &lt;&lt; <span class="stringliteral">&quot;read_beg: &quot;</span> &lt;&lt; read_beg &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line">    std::cout &lt;&lt; <span class="stringliteral">&quot;read_end: &quot;</span> &lt;&lt; read_end &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line">    std::cout &lt;&lt; <span class="stringliteral">&quot;cigar: &quot;</span> &lt;&lt; cigar &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line">    <span class="keywordflow">return</span> 0;</div>
<div class="line">}</div>
</div><!-- fragment --><h1><a class="anchor" id="autotoc_md28"></a>
Annotator</h1>
<div class="fragment"><div class="line"><span class="preprocessor">#include &lt;cassert&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;biovoltron/algo/annotate/annotator.hpp&gt;</span></div>
<div class="line"> </div>
<div class="line"><span class="keyword">using namespace </span>biovoltron;</div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">int</span> main() {</div>
<div class="line">    <span class="keyword">auto</span> genes = Annotator&lt;std::string&gt;{};</div>
<div class="line">    genes.insert_at(<span class="stringliteral">&quot;gene1&quot;</span>, Interval{<span class="stringliteral">&quot;chr1:5-15&quot;</span>});</div>
<div class="line">    genes.insert_at(<span class="stringliteral">&quot;gene2&quot;</span>, Interval{<span class="stringliteral">&quot;chr1:2-10&quot;</span>});</div>
<div class="line">    genes.insert_at(<span class="stringliteral">&quot;gene3&quot;</span>, Interval{<span class="stringliteral">&quot;chr1:20-30&quot;</span>});</div>
<div class="line">    genes.insert_at(<span class="stringliteral">&quot;gene4&quot;</span>, Interval{<span class="stringliteral">&quot;-chr2:2-10&quot;</span>});</div>
<div class="line">    genes.index();</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// result returns a vector of object, sorted by begin</span></div>
<div class="line">    <span class="keyword">auto</span> results = genes.find(Interval{<span class="stringliteral">&quot;chr1:6-12&quot;</span>});</div>
<div class="line">    assert(results.size() == 2);</div>
<div class="line">    assert(results[0] == <span class="stringliteral">&quot;gene2&quot;</span>);</div>
<div class="line">    assert(results[1] == <span class="stringliteral">&quot;gene1&quot;</span>);</div>
<div class="line"> </div>
<div class="line">    results = genes.find(Interval{<span class="stringliteral">&quot;-chr2:6-9&quot;</span>});</div>
<div class="line">    assert(results.size() == 1);</div>
<div class="line">    assert(results[0] == <span class="stringliteral">&quot;gene4&quot;</span>);</div>
<div class="line"> </div>
<div class="line">    results = genes.find(Interval{<span class="stringliteral">&quot;chr2:6-9&quot;</span>});</div>
<div class="line">    assert(results.empty());</div>
<div class="line"> </div>
<div class="line">    results = genes.find(Interval{<span class="stringliteral">&quot;chr2:0-2&quot;</span>});</div>
<div class="line">    assert(results.empty());</div>
<div class="line"> </div>
<div class="line">    results = genes.find(Interval{<span class="stringliteral">&quot;chr999:5-6&quot;</span>});</div>
<div class="line">    assert(results.empty());</div>
<div class="line">    <span class="keywordflow">return</span> 0;</div>
<div class="line">}</div>
</div><!-- fragment --><h1><a class="anchor" id="autotoc_md29"></a>
Variant calling</h1>
<div class="fragment"><div class="line"><span class="preprocessor">#include &lt;biovoltron/pipe/algo_pipe.hpp&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;iostream&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;range/v3/all.hpp&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;biovoltron/algo/sort/stable_sorter.hpp&gt;</span></div>
<div class="line"> </div>
<div class="line"><span class="keyword">using namespace </span>biovoltron;</div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">int</span> main() {</div>
<div class="line">    <span class="keyword">auto</span> ref = FastaRecord&lt;&gt;{};</div>
<div class="line">    std::ifstream{<span class="stringliteral">&quot;chr22.fa&quot;</span>} &gt;&gt; ref;</div>
<div class="line">    <span class="keyword">auto</span> index = ref | pipe::build&lt;uint32_t, StableSorter&lt;uint32_t&gt;&gt;{.LOOKUP_LEN = 8};</div>
<div class="line"> </div>
<div class="line">    <span class="keyword">auto</span> fq1 = std::ifstream{<span class="stringliteral">&quot;chr22.1.fq&quot;</span>};</div>
<div class="line">    <span class="keyword">auto</span> fq2 = std::ifstream{<span class="stringliteral">&quot;chr22.2.fq&quot;</span>};</div>
<div class="line">    <span class="keyword">auto</span> reads = ranges::view::zip(ranges::istream_range&lt;FastqRecord&lt;&gt;&gt;(fq1),</div>
<div class="line">        ranges::istream_range&lt;FastqRecord&lt;&gt;&gt;(fq2));</div>
<div class="line"> </div>
<div class="line">    <span class="keyword">const</span> <span class="keyword">auto</span> vars = reads</div>
<div class="line">        | pipe::align{.ref = ref, .index = std::move(index)}</div>
<div class="line">        | ranges::action::sort</div>
<div class="line">        | pipe::call{.ref = ref};</div>
<div class="line">    <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span>&amp; var : vars)</div>
<div class="line">        std::cout &lt;&lt; var &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line">    <span class="keywordflow">return</span> 0;</div>
<div class="line">}</div>
</div><!-- fragment --> </div></div><!-- contents -->
</div><!-- PageDoc -->
</div><!-- doc-content -->
<!-- HTML footer for doxygen 1.9.1-->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.1 </li>
  </ul>
</div>
  <script type="text/javascript">
    $(function() {
      $(document).ready(function(){
       toggleButton = document.createElement('doxygen-awesome-dark-mode-toggle')
       toggleButton.title = "Toggle Light/Dark Mode"
       document.getElementById("MSearchBox").parentNode.appendChild(toggleButton)
     })
    })
  </script>
</body>
</html>
